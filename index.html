<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Global Population & Geopolitical Risk Dashboard</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 0; padding: 0; line-height: 1.5; }
        header { background-color: #2E86C1; color: white; padding: 20px; text-align: center; }
        section { padding: 20px; max-width: 900px; margin: auto; }
        h2 { color: #2E86C1; }
        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
        th { background-color: #f0f0f0; }
        img { max-width: 100%; height: auto; display: block; margin: 10px auto; }
        pre { background-color: #f8f8f8; padding: 10px; border: 1px solid #ccc; overflow-x: auto; }
        @media (max-width: 600px) {
            body { padding: 5px; }
            table { font-size: 12px; }
        }
    </style>
</head>
<body>

<!-- 首頁 Landing Page -->
<header>
    <h1>Global Population & Geopolitical Risk Dashboard</h1>
    <p>研究主張：分析全球人口趨勢與伊朗地緣政治風險，提供決策參考。</p>
    <p>作者：黃晴筠</p>
</header>

<!-- 世界人口預測區塊 -->
<section>
    <h2>世界人口預測</h2>
    <img src="images/population_forecast.png" alt="World Population Forecast 2024-2100">
    <p style="font-size: 0.8rem; color: gray;">圖表來源：AI 生成 (Gemini)</p>
    <p>資料來源：UN World Population Prospects 2024</p>

    <!-- 人口數字表格 -->
    <table>
        <tr><th>年份</th><th>人口 (人)</th></tr>
        <tr><td>2024</td><td id="pop2024"></td></tr>
        <tr><td>2030</td><td id="pop2030"></td></tr>
        <tr><td>2050</td><td id="pop2050"></td></tr>
        <tr><td>2100</td><td id="pop2100"></td></tr>
    </table>

    <!-- CAGR & 成長率 -->
    <p><strong>CAGR (2024-2100)：</strong><span id="cagr"></span>%</p>
    <p><strong>年平均成長率：</strong><span id="avg-growth"></span>%</p>

    <!-- JSON 顯示 -->
    <h3>人口資料 (JSON)</h3>
    <pre id="json-display"></pre>
</section>

<!-- 伊朗地緣政治風險 -->
<section>
    <h2>Iran Risk Matrix</h2>
    <table>
        <tr>
            <th>風險因子</th>
            <th>機率</th>
            <th>影響程度</th>
            <th>資料來源</th>
        </tr>
        <tr>
            <td>政治不穩定</td>
            <td>高</td>
            <td>高</td>
            <td>Reuters (事實)</td>
        </tr>
        <tr>
            <td>國際制裁</td>
            <td>中</td>
            <td>高</td>
            <td>UN News (事實)</td>
        </tr>
        <tr>
            <td>軍事衝突風險</td>
            <td>低</td>
            <td>高</td>
            <td>AI 推論 (推論)</td>
        </tr>
        <tr>
            <td>能源價格波動</td>
            <td>中</td>
            <td>中</td>
            <td>Bloomberg (推論)</td>
        </tr>
    </table>
</section>

<!-- 方法論 -->
<section>
    <h2>方法論</h2>
    <p><strong>AI 使用方式：</strong>生成圖表、Risk Matrix 初稿、Python 資料清理程式提示。</p>
    <p><strong>資料驗證方式：</strong>人口數據以 UN WPP 2024 為最終依據，Risk Matrix 推論經人工比對多個來源，避免 AI 幻覺。</p>
    <p><strong>Prompt 範例：</strong> "Generate a population forecast chart for 2024, 2030, 2050, 2100 based on UN data"</p>
</section>

<!-- JSON 與人口計算腳本 -->
<script>
fetch('data/cleaned.json')
.then(response => response.json())
.then(data => {
    // 顯示 JSON
    document.getElementById('json-display').textContent = JSON.stringify(data, null, 2);

    // 將人口填入表格
    data.data.forEach(item => {
        if(item.year === 2024) document.getElementById('pop2024').textContent = item.population.toLocaleString();
        if(item.year === 2030) document.getElementById('pop2030').textContent = item.population.toLocaleString();
        if(item.year === 2050) document.getElementById('pop2050').textContent = item.population.toLocaleString();
        if(item.year === 2100) document.getElementById('pop2100').textContent = item.population.toLocaleString();
    });

    // 計算 CAGR 2024-2100
    const popStart = data.data.find(d => d.year === 2024).population;
    const popEnd = data.data.find(d => d.year === 2100).population;
    const years = 2100 - 2024;
    const cagr = (Math.pow(popEnd / popStart, 1 / years) - 1) * 100;
    document.getElementById('cagr').textContent = cagr.toFixed(2);

    // 計算平均成長率
    const growthRates = [];
    for(let i=1; i<data.data.length; i++){
        const prev = data.data[i-1].population;
        const curr = data.data[i].population;
        growthRates.push((curr - prev)/prev*100);
    }
    const avgGrowth = growthRates.reduce((a,b)=>a+b,0)/growthRates.length;
    document.getElementById('avg-growth').textContent = avgGrowth.toFixed(2);
});
</script>

</body>
</html>